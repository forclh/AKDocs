# âœ¨Promise çš„é™æ€æ–¹æ³• ðŸ‘Œ

## é‚“å“¥çš„æ–°é—®é¢˜

é‚“å«‚å‡ºé—¨æ—¶ï¼Œç»™é‚“å“¥äº¤å¾…äº†å‡ ä¸ªä»»åŠ¡ï¼š

1. åšé¥­

    å¯äº¤ç»™ç”µé¥­ç…²å®Œæˆ

2. æ´—è¡£æœ

    å¯äº¤ç»™æ´—è¡£æœºå®Œæˆ

3. æ‰“æ‰«å«ç”Ÿ

    å¯äº¤ç»™æ‰«åœ°æœºå™¨äººå®Œæˆ

é‚“å“¥éœ€è¦åœ¨æ‰€æœ‰ä»»åŠ¡ç»“æŸåŽç»™é‚“å«‚æ±‡æŠ¥å·¥ä½œï¼Œå“ªäº›æˆåŠŸäº†ï¼Œå“ªäº›å¤±è´¥äº†

ä¸ºäº†æœ€å¤§ç¨‹åº¦çš„èŠ‚çº¦æ—¶é—´ï¼Œé‚“å“¥å¸Œæœ›è¿™äº›ä»»åŠ¡åŒæ—¶è¿›è¡Œï¼Œæœ€ç»ˆæ±‡æ€»ç»“æžœç»Ÿä¸€å¤„ç†

![](http://mdrs.yuanjin.tech/img/20210621142519.png)

æ¯ä¸ªä»»åŠ¡å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªè¿”å›ž Promise çš„å‡½æ•°

```js
// åšé¥­
function cook() {
    return new Promise((resolve, reject) => {
        console.log("é‚“å“¥æ‰“å¼€äº†ç”µé¥­ç…²");
        setTimeout(() => {
            if (Math.random() < 0.5) {
                resolve("é¥­å·²ok");
            } else {
                reject("åšé¥­å´å¿˜äº†åŠ æ°´ï¼Œç±³é¥­å˜æˆäº†çˆ†ç±³èŠ±");
            }
        }, 2000);
    });
}

// æ´—è¡£æœ
function wash() {
    return new Promise((resolve, reject) => {
        console.log("é‚“å“¥æ‰“å¼€äº†æ´—è¡£æœº");
        setTimeout(() => {
            if (Math.random() < 0.5) {
                resolve("è¡£æœå·²ç»æ´—å¥½");
            } else {
                reject("æ´—è¡£æœæ—¶åœæ°´äº†ï¼Œæ´—äº†ä¸ªå¯‚å¯ž");
            }
        }, 2500);
    });
}

// æ‰“æ‰«å«ç”Ÿ
function sweep() {
    return new Promise((resolve, reject) => {
        console.log("é‚“å“¥æ‰“å¼€äº†æ‰«åœ°æœºå™¨äºº");
        setTimeout(() => {
            if (Math.random() < 0.5) {
                resolve("åœ°æ¿æ‰«çš„éžå¸¸å¹²å‡€");
            } else {
                reject("æ‰«åœ°æœºå™¨äººè¢«å“ˆå£«å¥‡ä¸€çˆªæŽ€ç¿»äº†");
            }
        }, 3000);
    });
}
```

å¦‚ä½•åˆ©ç”¨è¿™ä¸‰ä¸ªå‡½æ•°å®žçŽ°é‚“å“¥çš„è¦æ±‚å‘¢ï¼Ÿ

## Promise çš„é™æ€æ–¹æ³•

| æ–¹æ³•å                       | å«ä¹‰                                                      |
| ---------------------------- | --------------------------------------------------------- |
| Promise.resolve(data)        | ç›´æŽ¥è¿”å›žä¸€ä¸ª**å®ŒæˆçŠ¶æ€**çš„ä»»åŠ¡                            |
| Promise.reject(reason)       | ç›´æŽ¥è¿”å›žä¸€ä¸ª**æ‹’ç»çŠ¶æ€**çš„ä»»åŠ¡                            |
| Promise.all(ä»»åŠ¡æ•°ç»„)        | è¿”å›žä¸€ä¸ªä»»åŠ¡,**ä»»åŠ¡æ•°ç»„å…¨éƒ¨æˆåŠŸåˆ™æˆåŠŸä»»ä½•ä¸€ä¸ªå¤±è´¥åˆ™å¤±è´¥** |
| Promise.any(ä»»åŠ¡æ•°ç»„)        | è¿”å›žä¸€ä¸ªä»»åŠ¡,ä»»åŠ¡æ•°ç»„**ä»»ä¸€æˆåŠŸåˆ™æˆåŠŸä»»åŠ¡å…¨éƒ¨å¤±è´¥åˆ™å¤±è´¥** |
| Promise.allSettled(ä»»åŠ¡æ•°ç»„) | è¿”å›žä¸€ä¸ªä»»åŠ¡,ä»»åŠ¡æ•°ç»„**å…¨éƒ¨å·²å†³åˆ™æˆåŠŸ**è¯¥ä»»åŠ¡ä¸ä¼šå¤±è´¥     |
| Promise.race(ä»»åŠ¡æ•°ç»„)       | è¿”å›žä¸€ä¸ªä»»åŠ¡,ä»»åŠ¡æ•°ç»„**ä»»ä¸€å·²å†³åˆ™å·²å†³**ï¼ŒçŠ¶æ€å’Œå…¶ä¸€è‡´     |

## é‚“å“¥çš„è§£å†³æ–¹æ¡ˆ

```js
Promise.allSettled([cook(), wash(), sweep()]).then((result) => {
    // å¤„ç†æ±‡æ€»ç»“æžœ
    const report = result
        .map((r) => (r.status === "fulfilled" ? r.value : r.reason))
        .join(";");
    console.log(report);
});
```
