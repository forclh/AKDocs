# âœ¨ äº‹ä»¶å¤„ç† ğŸ‘Œ

[[TOC]]

## å¿«é€Ÿå…¥é—¨

åœ¨ Vue ä¸­ä½¿ç”¨ `v-on`ï¼ˆç¼©å†™ä¸º `@`ï¼‰ä¸ºå…ƒç´ ç»‘å®šäº‹ä»¶ï¼š

```vue
<template>
  <div>{{ count }}</div>
  <button v-on:click="add">+1</button>
  <button @click="add">+1ï¼ˆç®€å†™ï¼‰</button>
</template>

<script setup>
import { ref } from "vue";
const count = ref(0);
function add() {
  count.value++;
}
</script>
```

::: tip ä¹¦å†™å»ºè®®

- å¸¸è§„å†™æ³•ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼ˆå¦‚ `@click="add"`ï¼‰ï¼Œè¯­ä¹‰æ¸…æ™°ä¸”ä¾¿äºå¤ç”¨ã€‚
- ç®€å†™ `@` æ˜¯æ—¥å¸¸é¦–é€‰ï¼›æ ¹æ®å›¢é˜Ÿè§„èŒƒç»Ÿä¸€é£æ ¼å³å¯ã€‚
  :::

## å¤„ç†å™¨å†™æ³•ä¸ä¼ å‚

äº‹ä»¶å¤„ç†å™¨å¯å†™ä¸ºæ–¹æ³•ã€å†…è”è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°ï¼š

```vue
<template>
  <div>{{ count }}</div>
  <!-- æ–¹æ³•å¼•ç”¨ -->
  <button @click="add">+1</button>
  <!-- å†…è”è¡¨è¾¾å¼ï¼ˆé€»è¾‘æç®€å•åœºæ™¯ï¼‰ -->
  <button @click="count++">+1</button>
  <!-- ä¼ å‚è°ƒç”¨ -->
  <button @click="addWithMsg('Hello World')">+1</button>
</template>

<script setup>
import { ref } from "vue";
const count = ref(0);
function add() {
  count.value++;
}
function addWithMsg(message) {
  count.value++;
  console.log(message);
}
</script>
```

::: tip å¯è¯»æ€§ä¸æ€§èƒ½

- å¤æ‚é€»è¾‘å°½é‡å†™æˆæ–¹æ³•ï¼Œé¿å…åœ¨æ¨¡æ¿å†…å †å ä¸‰å…ƒ/é•¿è¡¨è¾¾å¼ã€‚
- åœ¨å¤§åˆ—è¡¨ä¸­é¿å…ä¸ºæ¯é¡¹åˆ›å»ºç®­å¤´å‡½æ•°ï¼Œä¼˜å…ˆæ–¹æ³•å¼•ç”¨æå‡å¯è¯»æ€§å’Œå¤ç”¨æ€§ã€‚
  :::

## äº‹ä»¶å¯¹è±¡ä¸ $event

ä¸ä¼ å‚æ—¶ï¼ŒåŸç”Ÿäº‹ä»¶å¯¹è±¡ä¼šè‡ªåŠ¨ä½œä¸ºé¢å¤–å‚æ•°ä¼ å…¥ï¼›ä¼ å‚æ—¶ç”¨ `$event` æ˜¾å¼ä¼ é€’ï¼š

```vue
<template>
  <button @click="onClick">+1</button>
</template>

<script setup>
function onClick(event) {
  console.log(event.target, event.clientX, event.clientY);
}
</script>
```

```vue
<template>
  <button @click="onClickWithMsg('Hello', $event)">+1</button>
</template>

<script setup>
function onClickWithMsg(message, event) {
  console.log(message, event.type);
}
</script>
```

ç®­å¤´å‡½æ•°æ—¶ç›´æ¥æ¥æ”¶äº‹ä»¶å¯¹è±¡ï¼š

```vue
<template>
  <button @click="(e) => onClickWithMsg('Hello', e)">+1</button>
</template>
```

::: tip `$event` çš„åœºæ™¯
å½“æ—¢è¦ä¼ è‡ªå®šä¹‰å‚æ•°åˆè¦æ‹¿åˆ°åŸç”Ÿäº‹ä»¶å¯¹è±¡æ—¶ï¼Œä½¿ç”¨ `$event` ä¼ é€’æ›´ç›´è§‚ã€‚
:::

## ä¿®é¥°ç¬¦

ä¿®é¥°ç¬¦ç”¨äºå¤„ç†éæ ¸å¿ƒä¸šåŠ¡ï¼ˆé˜»æ­¢å†’æ³¡ã€é˜»æ­¢é»˜è®¤ã€æ•è·ã€ä¸€æ¬¡æ€§ç­‰ï¼‰ï¼Œè®©å¤„ç†å™¨ä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼š

- `.stop`ï¼šé˜»æ­¢äº‹ä»¶å†’æ³¡
- `.prevent`ï¼šé˜»æ­¢é»˜è®¤è¡Œä¸º
- `.self`ï¼šä»…å½“äº‹ä»¶åœ¨å…ƒç´ æœ¬èº«è§¦å‘æ—¶æ‰å¤„ç†ï¼ˆéå­å…ƒç´ ï¼‰
- `.capture`ï¼šåœ¨æ•è·é˜¶æ®µè§¦å‘å¤„ç†å™¨
- `.once`ï¼šäº‹ä»¶åªè§¦å‘ä¸€æ¬¡
- `.passive`ï¼šæå‡æ»šåŠ¨ç›¸å…³äº‹ä»¶çš„æ€§èƒ½

```vue
<template>
  <div @click="parent">
    <button @click.stop="child">é˜»æ­¢å†’æ³¡</button>
    <form @submit.prevent="submit">é˜»æ­¢é»˜è®¤æäº¤</form>
    <div class="overlay" @click.self="close">ç‚¹å‡»é®ç½©æœ¬èº«æ‰å…³é—­</div>
  </div>
</template>

<script setup>
function parent() {
  console.log("parent");
}
function child() {
  console.log("child");
}
function submit() {
  console.log("submitted");
}
function close() {
  console.log("closed");
}
</script>
```

::: warning å…³äº `.passive`

- åœ¨è¢«æ ‡è®°ä¸º `passive` çš„ç›‘å¬å™¨ä¸­è°ƒç”¨ `event.preventDefault()` å°†è¢«å¿½ç•¥å¹¶è§¦å‘æ§åˆ¶å°è­¦å‘Šã€‚
- é€‚ç”¨äº `touchstart/touchmove`ã€`wheel` ç­‰æ»šåŠ¨ç›¸å…³äº‹ä»¶ä»¥æå‡æ€§èƒ½ã€‚
  :::

## ä¿®é¥°ç¬¦è¿ç”¨

ä¿®é¥°ç¬¦å¯è¿ç”¨ï¼Œç»„åˆä¸åŒç»´åº¦çš„è¡Œä¸ºæ§åˆ¶ï¼š

```vue
<button @click.capture.stop.prevent.once="handle">click</button>

<script setup>
function handle() {
  console.log("handled once in capture phase");
}
</script>
```

::: tip é¡ºåºå½±å“
ä¸åŒä¿®é¥°ç¬¦ä¾§é‡ç‚¹ä¸åŒï¼ˆä¼ æ’­ã€é»˜è®¤è¡Œä¸ºã€é˜¶æ®µã€æ¬¡æ•°ï¼‰ï¼Œé€šå¸¸è¿ç”¨æ—¶é¡ºåºä¸å½±å“æœ€ç»ˆç»“æœã€‚
:::

## æŒ‰é”®ä¿®é¥°ç¬¦

ç”¨äºé”®ç›˜äº‹ä»¶çš„å¿«æ·åˆ¤æ–­ï¼š

- `.enter` `.tab` `.delete`ï¼ˆå« Delete & Backspaceï¼‰ `.esc` `.space`
- `.up` `.down` `.left` `.right`
- ç»„åˆï¼š`.ctrl` `.alt` `.shift` `.meta`

```vue
<template>
  <input type="text" @keyup.enter="submitText" />
  <input type="text" @keyup.alt.enter="submitText" />
</template>

<script setup>
function submitText() {
  console.log("æäº¤è¾“å…¥å†…å®¹");
}
</script>
```

::: tip `.meta` ä¸å¹³å°
Windows/Linux ä¸‹ä¸º `Windows` é”®ï¼›macOS ä¸º `Command` é”®ã€‚
:::

### ç²¾ç¡®åŒ¹é…ï¼š.exact

è¦æ±‚ä»…åœ¨æŒ‡å®šç»„åˆæŒ‰ä¸‹ã€ä¸”æ— å…¶ä»–æŒ‰é”®å‚ä¸æ—¶è§¦å‘ï¼š

```vue
<button @click.ctrl.exact="onClick">åªåœ¨å•ç‹¬æŒ‰ä¸‹ Ctrl æ—¶è§¦å‘</button>
```

## é¼ æ ‡æŒ‰é”®ä¿®é¥°ç¬¦

æŒ‡å®šç‰¹å®šçš„é¼ æ ‡æŒ‰é”®ï¼š`.left` `.right` `.middle`ã€‚å³é”®ç¤ºä¾‹ï¼š

```vue
<template>
  <button
    class="context-menu-button"
    @contextmenu.prevent.right="handleRightClick"
  >
    å³é”®ç‚¹å‡»
  </button>
</template>

<script setup>
function handleRightClick() {
  console.log("ä½ ç‚¹å‡»äº†é¼ æ ‡å³é”®");
}
</script>

<style scoped>
.context-menu-button {
  padding: 10px 20px;
  cursor: context-menu;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 5px;
}
</style>
```

## è¿›é˜¶ï¼šç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶ï¼ˆç®€è¿°ï¼‰

ç»„ä»¶ä¹‹é—´çš„äº‹ä»¶é€šä¿¡ä½¿ç”¨ `defineEmits`ï¼š

```vue
<!-- å­ç»„ä»¶ -->
<script setup>
const emit = defineEmits(["submit"]);
function onSubmit(payload) {
  emit("submit", payload);
}
</script>

<!-- çˆ¶ç»„ä»¶ -->
<Child @submit="handleSubmit" />
```

::: tip åŒºåˆ†åœºæ™¯
DOM äº‹ä»¶ç”¨ `v-on/@`ï¼›ç»„ä»¶äº‹ä»¶ç”¨ `defineEmits` + `emit`ã€‚
:::

## å°ç»“

- ä¼˜å…ˆä½¿ç”¨æ–¹æ³•å¼•ç”¨ç»‘å®šäº‹ä»¶ï¼Œé€»è¾‘ç®€å•æ—¶å¯ç”¨å†…è”æˆ–ç®­å¤´å‡½æ•°ã€‚
- `$event` ç”¨äºåœ¨ä¼ å‚åœºæ™¯æ˜¾å¼ä¼ é€’åŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼›ç®­å¤´å‡½æ•°å¯ç›´æ¥æ¥æ”¶äº‹ä»¶å¯¹è±¡ã€‚
- ä¿®é¥°ç¬¦è®©å¤„ç†å™¨èšç„¦ä¸šåŠ¡é€»è¾‘ï¼›æ»šåŠ¨ç›¸å…³åœºæ™¯æ…ç”¨ `.passive` ä¸ `preventDefault`ã€‚
- æŒ‰é”®ä¸é¼ æ ‡ä¿®é¥°ç¬¦æå‡å¯è¯»æ€§ï¼›`.exact` æ§åˆ¶ç²¾ç¡®ç»„åˆåŒ¹é…ã€‚
- ç»„ä»¶äº‹ä»¶é€šè¿‡ `defineEmits/emit` è¿›è¡Œé€šä¿¡ï¼Œä¸ DOM äº‹ä»¶åŒºåˆ†ä½¿ç”¨ã€‚
