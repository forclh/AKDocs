# âœ¨ å‰ç«¯è·¯ç”±ä»‹ç» ğŸ‘Œ

[[TOC]]

::: info å¿«é€Ÿæ€»è§ˆ

- å‰ç«¯è·¯ç”±ç”¨äºåœ¨å•é¡µåº”ç”¨ä¸­â€œæ— åˆ·æ–°åˆ‡æ¢è§†å›¾â€ã€‚
- Vue 3 ä½¿ç”¨ `vue-router@4`ï¼Œæ¨è `history` æ¨¡å¼ï¼ˆéœ€æœåŠ¡ç«¯æ”¯æŒï¼‰ã€‚
- å…³é”®ç»„ä»¶ï¼š`<router-link>` è´Ÿè´£è·³è½¬ï¼Œ`<router-view>` è´Ÿè´£æ¸²æŸ“åŒ¹é…åˆ°çš„ç»„ä»¶ã€‚
- è·¯ç”±é…ç½®åŒ…å« `path`ã€`name`ã€`component`ï¼Œå¯æ‹“å±• `children`ã€`meta` ç­‰ã€‚
- å¸¸ç”¨ç‰¹æ€§ï¼šåŠ¨æ€å‚æ•°ã€åµŒå¥—è·¯ç”±ã€æ‡’åŠ è½½ã€ç¼–ç¨‹å¼å¯¼èˆªã€å®ˆå«ã€‚
  :::

## ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±

å®é™…ä¸Šåœ¨æœ€æ—©çš„å¤šé¡µåº”ç”¨æ—¶ä»£ï¼Œå¹¶ä¸å­˜åœ¨å‰ç«¯è·¯ç”±è¿™ä¹ˆä¸€è¯´ï¼Œé‚£ä¸ªæ—¶å€™è·¯ç”±æ˜¯å±äºåç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„ä¸œè¥¿ï¼Œåç«¯ä¼šæ ¹æ®ä¸åŒçš„è¯·æ±‚è·¯ç”±è¿”å›ä¸åŒçš„é¡µé¢ã€‚

![](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2024-04-16-235256.jpg)

åœ¨æ­¤å¼€å‘æ—¶æœŸæœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š

- æ•´ä¸ªé¡¹ç›®çš„å‰åç«¯ä»£ç æ˜¯æ‚ç³…åœ¨ä¸€èµ·çš„ã€‚
- å¤šé¡µåº”ç”¨æ—¶ä»£ï¼Œæ¯æ¬¡åˆ‡æ¢ä¸€ä¸ªé¡µé¢ï¼Œéƒ½éœ€è¦é‡æ–°è¯·æ±‚æœåŠ¡å™¨ã€‚

åé¢æ…¢æ…¢å°±åˆ°äº†å•é¡µåº”ç”¨æ—¶ä»£ï¼Œè¯¥æ—¶ä»£çš„ç‰¹ç‚¹å°±æ˜¯åªæœ‰ä¸€ä¸ª HTML é¡µé¢ï¼Œä»¥å‰è§†å›¾çš„åˆ‡æ¢æ˜¯æ•´ä¸ª HTML é¡µé¢çš„åˆ‡æ¢ï¼Œè€Œç°åœ¨è§†å›¾çš„åˆ‡æ¢æ˜¯é¡µé¢ä¸ŠæŸä¸ªæ¨¡å—çš„åˆ‡æ¢ã€‚

![](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2024-04-16-235800.jpg)

ä¸Šå›¾ä¸­çš„æ¨¡å—å…¶å®å°±æ˜¯å¯¹åº” Vue ä¸­ä¸åŒçš„ç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶æˆ‘ä»¬ç§°ä¹‹ä¸ºé¡µé¢çº§ç»„ä»¶ viewsã€‚æœ‰äº†é¡µé¢çº§ç»„ä»¶ï¼Œéœ€è¦å’Œè·¯ç”±äº§ç”Ÿä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯å‰ç«¯è·¯ç”±ã€‚

è™½ç„¶æœ‰äº†å‰ç«¯è·¯ç”±ï¼Œä½†æ˜¯åç«¯è·¯ç”±ä»ç„¶å­˜åœ¨ï¼Œåªä¸è¿‡ä»ä¹‹å‰çš„è·¯ç”±å’Œé¡µé¢çš„æ˜ å°„å…³ç³»å˜æˆäº†è·¯ç”±å’Œæ•°æ®æ¥å£ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚

## Vue Routerï¼ˆVue 3ï¼‰

Vue å®˜æ–¹çš„å‰ç«¯è·¯ç”±åº“ï¼šVue Router æ–‡æ¡£ https://router.vuejs.org/zh/

```bash
npm i vue-router@4
```

::: tip çº¦å®šä¸å»ºè®®

- è·¯ç”±é…ç½®æ–‡ä»¶é€šå¸¸ä½äº `src/router/index.js`ã€‚
- é¡µé¢çº§ç»„ä»¶å»ºè®®æ”¾åœ¨ `src/views` ç›®å½•ã€‚
- è·¯ç”± `name` å»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„é©¼å³°/å¸•æ–¯å¡å‘½åï¼Œä¾¿äºç¼–ç¨‹å¼å¯¼èˆªã€‚
  :::

### å¿«é€Ÿå…¥é—¨ï¼ˆ3 æ­¥ï¼‰

1. åˆ›å»ºä¸¤ä¸ªé¡µé¢ç»„ä»¶ `Home.vue`ã€`About.vue`ï¼ˆä½äº `src/views`ï¼‰ã€‚
2. åœ¨ `src/router/index.js` åˆ›å»ºå¹¶å¯¼å‡ºè·¯ç”±å®ä¾‹ã€‚
3. åœ¨å…¥å£ `main.js` æŒ‚è½½è·¯ç”±ï¼Œé¡µé¢ä½¿ç”¨ `<router-link>` å’Œ `<router-view>`ã€‚

```js
// src/router/index.js
import { createRouter, createWebHistory } from "vue-router";
import Home from "../views/Home.vue";
import About from "../views/About.vue";

const router = createRouter({
  // å¸¸è§æ¨¡å¼ï¼šcreateWebHistory() æˆ– createWebHashHistory()
  history: createWebHistory(),
  routes: [
    { path: "/", name: "Home", component: Home },
    { path: "/about", name: "About", component: About },
  ],
});

export default router;
```

```js
// src/main.js
import { createApp } from "vue";
import App from "./App.vue";
import router from "./router";

createApp(App).use(router).mount("#app");
```

```vue
<!-- src/App.vue -->
<template>
  <div id="app">
    <h1>æ¬¢è¿æ¥åˆ° Vue Router å¿«é€Ÿå…¥é—¨ç¤ºä¾‹</h1>
    <nav>
      <router-link to="/">Home</router-link>
      <router-link to="/about">About</router-link>
    </nav>
    <router-view />
  </div>
</template>

<script setup></script>

<style scoped>
#app {
  text-align: center;
  color: #2c3e50;
}
nav a {
  padding: 12px;
}
</style>
```

::: tip ç»„ä»¶è¯´æ˜

- `router-link`ï¼šå£°æ˜å¼å¯¼èˆªï¼Œæ”¯æŒ `to`ã€`replace`ã€`active-class` ç­‰å±æ€§ã€‚
- `router-view`ï¼šæ¸²æŸ“å½“å‰åŒ¹é…çš„è·¯ç”±ç»„ä»¶ï¼Œæ”¯æŒåµŒå¥—ã€‚
  :::

::: warning history æ¨¡å¼ä¸æœåŠ¡ç«¯
`createWebHistory()` ä¾èµ–æœåŠ¡ç«¯æ­£ç¡®è¿”å›åŒä¸€ HTMLï¼ˆä¾‹å¦‚é…ç½® Nginx çš„ fallbackï¼‰ã€‚å¦åˆ™ç”¨æˆ·åœ¨åˆ·æ–°éæ ¹è·¯å¾„æ—¶ä¼šå¾—åˆ° 404ã€‚
:::

::: danger å¸¸è§å‘

- å¿˜è®°åœ¨å…¥å£é€šè¿‡ `app.use(router)` å®‰è£…è·¯ç”±ã€‚
- å†…éƒ¨è·³è½¬ä½¿ç”¨ `<a>` å¯¼è‡´æ•´é¡µåˆ·æ–°ï¼Œåº”ä½¿ç”¨ `<router-link>` æˆ– `router.push`ã€‚
- é”™é… `base` æˆ–é™æ€èµ„æºè·¯å¾„ï¼Œå¯¼è‡´ history æ¨¡å¼ä¸‹èµ„æº 404ã€‚
  :::

## è·¯ç”±æ¨¡å¼é€‰æ‹©

- `history`ï¼šæ›´ä¼˜é›…çš„ URLï¼Œæ—  `#`ï¼›éœ€æœåŠ¡å™¨æ”¯æŒå›é€€åˆ°å…¥å£ HTMLã€‚
- `hash`ï¼šURL ä¸­åŒ…å« `#`ï¼Œä¸éœ€æœåŠ¡å™¨é…ç½®ï¼›é€‚åˆé™æ€æ‰˜ç®¡æˆ–æ— æœåŠ¡ç«¯æ”¯æŒåœºæ™¯ã€‚

```js
import {
  createRouter,
  createWebHistory,
  createWebHashHistory,
} from "vue-router";
const router = createRouter({
  history: createWebHistory(), // æˆ– createWebHashHistory()
  routes: [],
});
```

::: tip é€‰æ‹©å»ºè®®

- æœ‰æœåŠ¡ç«¯æ”¯æŒï¼šä¼˜å…ˆ `history`ã€‚
- çº¯é™æ€åœºæ™¯ï¼šä½¿ç”¨ `hash` æ›´çœäº‹ã€‚
  :::

## è·¯ç”±ç‰¹æ€§é€Ÿè§ˆä¸ç¤ºä¾‹

### åŠ¨æ€å‚æ•°ï¼ˆparamsï¼‰

```js
// /src/router/index.js
routes: [
  {
    path: "/user/:id",
    name: "User",
    component: () => import("../views/User.vue"),
  },
];
```

```vue
<!-- /src/views/User.vue -->
<template>
  <section>
    <h2>User {{ id }}</h2>
  </section>
</template>
<script setup>
import { useRoute } from "vue-router";
const route = useRoute();
const id = route.params.id;
</script>
```

::: tip ç¼–ç¨‹å¼å¯¼èˆª

```js
import { useRouter } from "vue-router";
const router = useRouter();
router.push({ name: "User", params: { id: 123 } });
```

:::

### åµŒå¥—è·¯ç”±ï¼ˆchildrenï¼‰

```js
// /src/router/index.js
routes: [
  {
    path: "/settings",
    component: () => import("../views/Settings/index.vue"),
    children: [
      {
        path: "",
        name: "SettingsHome",
        component: () => import("../views/Settings/Home.vue"),
      },
      {
        path: "profile",
        name: "SettingsProfile",
        component: () => import("../views/Settings/Profile.vue"),
      },
    ],
  },
];
```

```vue
<!-- /src/views/Settings/index.vue -->
<template>
  <h2>Settings</h2>
  <nav>
    <router-link to="/settings">Home</router-link>
    <router-link to="/settings/profile">Profile</router-link>
  </nav>
  <router-view />
</template>
```

### æ‡’åŠ è½½ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰

```js
const routes = [
  { path: "/", component: () => import("../views/Home.vue") },
  { path: "/about", component: () => import("../views/About.vue") },
];
```

::: tip æ€§èƒ½å»ºè®®

- ä¸ºä¸­å¤§å‹åº”ç”¨å¯ç”¨è·¯ç”±ç»„ä»¶æ‡’åŠ è½½ï¼Œå‡å°‘é¦–å±åŒ…ä½“ç§¯ã€‚
- å¯¹é¢‘ç¹è®¿é—®çš„é¡µé¢å¯è€ƒè™‘é¢„åŠ è½½ï¼ˆ`link rel="preload"` æˆ–æ¡†æ¶æä¾›çš„é¢„åŠ è½½æ‰‹æ®µï¼‰ã€‚
  :::

### å‘½åè·¯ç”±ä¸åˆ«å

```js
{ path: '/about', name: 'About', component: About, alias: ['/intro', '/info'] }
// ä½¿ç”¨ name å¯¼èˆªæ›´ç¨³å¥
router.push({ name: 'About' })
```

::: warning å‘½åä¸è·¯å¾„ç»´æŠ¤
æ›´æ”¹ `path` ä¸å½±å“ä»¥ `name` ä¸ºç›®æ ‡çš„å¯¼èˆªï¼›ç›¸åå¦‚æœåªç”¨ `to:'/about'`ï¼Œé‡æ„è·¯å¾„æ—¶æ›´å®¹æ˜“é—æ¼ã€‚
:::

## è¿›ä¸€æ­¥äº†è§£

- å¯¼èˆªå®ˆå«ï¼šå…¨å±€ã€è·¯ç”±ã€ç»„ä»¶å†…å®ˆå«ï¼Œå¯ç”¨äºé‰´æƒä¸æ•°æ®é¢„å–ã€‚
- è·¯ç”±å…ƒä¿¡æ¯ï¼š`meta` å¯æºå¸¦æƒé™ã€æ ‡é¢˜ç­‰è¾…åŠ©ä¿¡æ¯ã€‚
- é“¾æ¥æ´»è·ƒæ ·å¼ï¼šé»˜è®¤ç±»å `router-link-active` / `router-link-exact-active`ã€‚

æ›´å¤šé«˜çº§ç”¨æ³•è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://router.vuejs.org/zh/

::: tip å­¦ä¹ å»ºè®®

- å…ˆæŒæ¡â€œå¿«é€Ÿå…¥é—¨â€å’Œâ€œåŠ¨æ€å‚æ•°ã€åµŒå¥—ã€æ‡’åŠ è½½â€ã€‚
- å†é€æ­¥å¼•å…¥â€œå‘½åè·¯ç”±ã€åˆ«åã€å®ˆå«ã€å…ƒä¿¡æ¯â€ç­‰å¢å¼ºç‰¹æ€§ã€‚
  :::
