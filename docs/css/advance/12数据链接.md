# 数据链接 👌

数据链接（Data URL）是一种将**文件数据直接嵌入到 URL 中的技术**，允许在不发起额外 HTTP 请求的情况下引用资源。

## 1. 基本概念

### 1.1 定义

数据链接是将目标文件的数据直接书写到路径位置，而不是通过传统的文件路径引用。

### 1.2 语法格式

```
data:[<mediatype>][;base64],<data>
```

**参数说明：**

- `mediatype`：MIME 类型（可选），如 `image/png`、`text/css` 等
- `base64`：编码方式标识（可选），表示数据使用 base64 编码
- `data`：实际的数据内容

## 2. 常见用法示例

### 2.1 图片数据链接

```html :collapsed-lines
<!-- 直接嵌入小图标 -->
<img
  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg=="
  alt="1x1像素透明图片"
/>

<!-- CSS 中使用 -->
<style>
  .icon {
    background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMTJMMy41IDcuNUg2VjRIMTBWNy41SDEyLjVMOCAxMloiIGZpbGw9IiMzMzMiLz4KPC9zdmc+");
  }
</style>
```

### 2.2 文本数据链接

```html :collapsed-lines
<!-- 嵌入 CSS -->
<link
  rel="stylesheet"
  href="data:text/css;base64,Ym9keSB7IGJhY2tncm91bmQtY29sb3I6ICNmMGYwZjA7IH0="
/>

<!-- 嵌入 JavaScript -->
<script src="data:text/javascript;base64,YWxlcnQoJ0hlbGxvIFdvcmxkIScpOw=="></script>
```

### 2.3 SVG 数据链接

```html :collapsed-lines
<!-- 直接嵌入 SVG（无需 base64 编码）-->
<img
  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16'%3E%3Ccircle cx='8' cy='8' r='6' fill='%23ff0000'/%3E%3C/svg%3E"
  alt="红色圆圈"
/>
```

## 3. 优势与劣势分析

### 3.1 优势

| 优势               | 说明                                 | 适用场景             |
| ------------------ | ------------------------------------ | -------------------- |
| **减少 HTTP 请求** | 避免额外的网络请求，提升页面加载速度 | 小图标、装饰性图片   |
| **避免文件丢失**   | 数据直接嵌入，不会出现 404 错误      | 关键的小资源         |
| **动态生成便利**   | 便于通过代码动态生成和修改           | 程序生成的图片或样式 |
| **离线可用**       | 不依赖外部文件，离线环境下仍可使用   | 离线应用、邮件模板   |

### 3.2 劣势

| 劣势             | 说明                           | 影响             |
| ---------------- | ------------------------------ | ---------------- |
| **增加文档体积** | Base64 编码会增加约 33% 的体积 | 影响首次加载速度 |
| **无法缓存**     | 浏览器无法单独缓存数据链接资源 | 重复加载相同资源 |
| **调试困难**     | 编码后的数据难以直接查看和调试 | 开发维护成本增加 |
| **内存占用**     | 大量数据链接会增加内存使用     | 可能影响页面性能 |

## 4. Base64 编码详解

### 4.1 什么是 Base64

Base64 是一种**基于 64 个可打印字符来表示二进制数据的编码方式**。它使用 A-Z、a-z、0-9、+、/ 这 64 个字符，以及 = 作为填充字符。

### 4.2 编码原理

- 将二进制数据按 3 个字节（24 位）为一组进行分组
- 每组 24 位分成 4 个 6 位的片段
- 每个 6 位片段对应一个 Base64 字符
- 体积增加约 33%（4/3 倍）

### 4.3 在线转换工具

```javascript
// JavaScript 中的 Base64 编码/解码
// 编码
const encoded = btoa("Hello World"); // SGVsbG8gV29ybGQ=

// 解码
const decoded = atob("SGVsbG8gV29ybGQ="); // Hello World
```

## 5. 总结

数据链接是一个强大的 Web 技术，在合适的场景下能够显著提升用户体验。关键是要权衡其优劣势，在小资源、动态生成、离线应用等场景下合理使用，避免滥用导致的性能问题。

**使用原则：**

- 小而美：资源体积小（< 2KB）
- 少而精：不频繁重复使用
- 快而稳：提升加载速度和稳定性
